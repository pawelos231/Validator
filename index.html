<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <form id="formularz">
        <input  name="imie" type="text" placeholder="imie">
        <input required name="nazwisko" type="text" placeholder="nazwisko">
        <input required name="email" type="email" placeholder="email">
        <input required name="pesel" type="number"  placeholder="pesel">
        <input name="wiek" type="number" placeholder="wiek">
        <select name="plec">pleć: 
            <option value="kobieta">kobieta</option>
            <option value="mezczyzna">mezczyzna</option>
        </select>
        <input maxlength="9" name="telefon" type="text"  placeholder="telefon">
        <input maxlength="3"  name="klasa" type="text" placeholder="klasa">
        <input name="wydawca" type="text" placeholder="wydawca">
        <input name="ISBN" type="text" placeholder="ISBN">
        <input  type="submit">
    </form>
    <script>
        
        var isValidIsbn = function(str) {

var sum,
    weight,
    digit,
    check,
    i;

str = str.replace(/[^0-9X]/gi, '');

if (str.length != 10 && str.length != 13) {
    return false;
}

if (str.length == 13) {
    sum = 0;
    for (i = 0; i < 12; i++) {
        digit = parseInt(str[i]);
        if (i % 2 == 1) {
            sum += 3*digit;
        } else {
            sum += digit;
        }
    }
    check = (10 - (sum % 10)) % 10;
    return (check == str[str.length-1]);
}

if (str.length == 10) {
    weight = 10;
    sum = 0;
    for (i = 0; i < 9; i++) {
        digit = parseInt(str[i]);
        sum += weight*digit;
        weight--;
    }
    check = (11 - (sum % 11)) % 11
    if (check == 10) {
        check = 'X';
    }
    return (check == str[str.length-1].toUpperCase());
}
}

      
        const form = document.getElementById("formularz")
        
        

        form.addEventListener("submit", (e)=>{

            const ValidateChecker = [{
            value: form.imie.value,
            method: function(){
                console.log(this.value, "C")
                if(this.value == ""){
                    alert("wprowadz poprawne imie")
                    return false
                }
            }
        }, {
            value: form.wiek.value,
            method: function(){
                const wiek = this.value
                if(Number(wiek) < 2 || Number(wiek) > 99){
                    alert("wprowadz poprawny wiek")
                    return false
                }
            }
        }, {
            value: form.nazwisko.value,
            method: function(){
                if(this.value == ""){
                    alert("wprowadz poprawne nazwisko")
                    return false
                }
            }
        },
        , {
            value: form.email.value,
            method: function(){
                return String(this.value)
                .toLowerCase()
                .match(
                    /^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/
                    );
            }
        },
        {
            value: form.pesel.value,
            method: function(){
                const pesel = this.value

                const ValidatePesel = () =>{     
                let weight = [1, 3, 7, 9, 1, 3, 7, 9, 1, 3];
                let sum = 0;
                let controlNumber = Number(pesel.substring(10, 11));

                for (let i = 0; i < weight.length; i++) {
                    sum += (Number(pesel.substring(i, i + 1)) * weight[i]);
                }
                sum = sum % 10;
                return (10 - sum) % 10 === controlNumber;
                }
                if(ValidatePesel() == false || pesel == ""){
                    alert("zly pseel")
                    return false;
                }
               
            }
        },
        {
            value: form.plec.value,
            method: function(){
                console.log(this.value, "C")
                if(this.value == ""){
                    alert("wprowadz poprawne dane")
                    return false
                }
            }
        }, 
        {
            value: form.telefon.value,
            method: function(){
                console.log(this.value, "C")
                if(this.value == ""){
                    alert("wprowadz poprawny telefon")
                    return false
                }
            }
        },
        {
            value: form.klasa.value,
            method: function(){
                console.log(this.value, "C")
                if(this.value == ""){
                    alert("wprowadz poprawną klase")
                    return false
                }
            }
        },
        {
            value: form.wydawca.value,
            method: function(){
                console.log(this.value, "C")
                if(this.value == ""){
                    alert("wprowadz poprawnego wydawce")
                    return false
                }
            }
        },
        {
            value: form.ISBN.value,
            method: function(){
                if(!isValidIsbn(this.value) || this.value == ""){
                    alert("niepoprawny isbn")
                    return false
                }
            }
        },      
    ]
            e.preventDefault() 
    
            ValidateChecker.forEach(item=>{
                item.method();
            })

            const formData = new FormData(form)              
           
        })
        
    </script>
</body>
</html>